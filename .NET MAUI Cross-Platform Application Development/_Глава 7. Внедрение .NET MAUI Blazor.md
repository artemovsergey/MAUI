# Внедрение .NET MAUI Blazor

Во второй части этой книги мы узнаем, как создать приложение .NET MAUI Blazor Hybrid. Блейзор
— это платформа одностраничных приложений (SPA), в которой компоненты Razor используются в качестве стандартных блоков. Ты мог бы
слышали о других фреймворках SPA, таких как React, Angular, Vue и так далее. Большинство фреймворков SPA
используйте JavaScript, но Blazor использует C# вместо JavaScript. Blazor также можно использовать для создания так называемого
Гибридное приложение Blazor. В приложении Blazor Hybrid компоненты Razor изначально запускаются на устройстве.
с помощью встроенного элемента управления Web View, чтобы приложение Blazor Hybrid могло получить доступ к функциям устройства в
так же, как родное приложение. Мы перестроим наше приложение как приложение Blazor Hybrid во второй части.
четыре главы во второй части.

Этот раздел состоит из следующих глав:

* Глава 7, Введение в разработку гибридных приложений Blazor

* Глава 8, Общие сведения о макете и маршрутизации Blazor

* Глава 9, Реализация компонентов Blazor

* Глава 10, Дополнительные темы по созданию компонентов Razor

В .NET MAUI есть еще один способ создания пользовательского интерфейса — использование Blazor. Блейзор может быть
используется в качестве одностраничного приложения (SPA) для разработки веб-приложений. Его также можно использовать
для разработки приложений .NET MAUI в форме приложения Blazor Hybrid. Строительным блоком Blazor является
Компонент бритвы. Используя Blazor и Blazor Hybrid, мы можем повторно использовать компоненты Razor между собственными
приложения и веб-приложения. По сравнению с пользовательским интерфейсом XAML пользовательский интерфейс Blazor обеспечивает более высокую степень повторного использования, что
включает в себя как собственные приложения, так и веб-приложения. В этой главе мы представим, что такое Blazor, и объясним
его использование в различных сценариях. Мы также расскажем о компоненте Razor и о том, как разработать
Приложение Blazor Hybrid с использованием компонентов Razor.

В этой главе мы рассмотрим следующие темы:

* Что такое Блазор?

* Как создать проект .NET MAUI Blazor

* Как создать новый компонент Razor

# Технические требования

Для тестирования и отладки исходного кода в этой главе вам необходимо установить Visual Studio 2022 на
ваш ПК или Mac. Пожалуйста, обратитесь к разделу Настройка среды разработки в Главе 1, Получение
Начал с .NET MAUI, подробнее.
Исходный код для этой главы доступен в следующем репозитории GitHub: https://github.
com/PacktPublishing/.NET-MAUI-Кроссплатформенное-Приложение-Разработка/
дерево/главная/Chapter07.
Исходный код можно загрузить с помощью следующей команды git:

```
git clone -b Chapter07 https://github.com/PacktPublishing/.NET-MAUI-Cross-Platform-Application-Development PassXYZ.Vault2
```

# Что такое Блазор?

Blazor — это платформа для создания веб-приложений с использованием HTML, CSS и C#. Для создания веб
приложений, использующих Blazor в ASP.NET Core, можно выбрать один из двух вариантов: Blazor
Сервер и Blazor WebAssembly (Wasm). Благодаря .NET MAUI Blazor также можно использовать для создания собственного
приложений, и это третья форма — приложение Blazor Hybrid.
При разработке веб-приложений задачи обычно включают создание пользовательского интерфейса внешнего интерфейса и
серверная служба. Доступ к серверным службам осуществляется через RESTful API или удаленные вызовы процедур.
(РПЦ). Компоненты пользовательского интерфейса состоят из HTML, CSS и JavaScript. они загружены
в браузере и отображаются как веб-страницы. Мы можем визуализировать компоненты, связанные с взаимодействием с пользователем
на сервере в архитектуре ASP.NET Core. Эта модель хостинга — Blazor Server. Мы также можем
выбрать выполнение большинства компонентов пользовательского интерфейса в браузере; эта модель хостинга называется
Блазор Васм. В некоторых приложениях у нас есть требования к приложению для доступа к конкретным устройствам.
функции, такие как датчики или камеры. В этом случае нам обычно нужно разрабатывать собственные приложения для
соответствовать таким требованиям. С Blazor у нас есть еще один вариант — приложение Blazor Hybrid. Первый,
давайте поговорим о Blazor Server.

# Изучение Blazor Server

В традиционной разработке веб-приложений логика взаимодействия с пользователем выполняется на стороне сервера.
В шаблоне проектирования MVC обработка взаимодействия с пользователем является частью архитектуры приложения. Если
происходит взаимодействие с пользователем в браузере, оно отправляется обратно на сервер для обработки. В ответ на
запрос пользователя, вся страница может быть перезагружена. Для повышения производительности Blazor Server использует
дизайн, похожий на структуру SPA. Чтобы ответить на запрос пользователя, Blazor Server обрабатывает
запрос, и он отправляет только изменения объектной модели документа (DOM), связанные с действием пользователя, на
браузер. В Blazor Server, как мы видим на рис. 7.1, логика обработки такая же, как и в SPA.
с той разницей, что компоненты Razor отображаются на сервере, а не в браузере.
SignalR — библиотека с открытым исходным кодом, которую можно использовать для связи между веб-клиентом в режиме реального времени.
и сервер, используется как соединение между сервером и браузером:

![изображение](https://user-images.githubusercontent.com/26972859/231839550-5e6ea496-5989-404d-ac65-058ad47db77f.png)

Рисунок 7.1: Сервер Blazor


# Компоненты Razor и компоненты Blazor

Люди могут запутаться между Blazor и Razor. Razor был представлен как шаблонизатор.
ASP.NET в 2010 году. Синтаксис Razor — это синтаксис разметки, в который разработчики могут встраивать код C#.
в HTML-страницу. Blazor — это платформа SPA, использующая синтаксис Razor в качестве основы программирования.
язык. Он был представлен примерно в 2018 году. Blazor — это фреймворк, основанный на компонентах, и
Приложение Blazor состоит из компонентов Razor. Другими словами, Blazor — это модель хостинга для Razor.
компоненты. Компоненты Blazor и компоненты Razor широко используются взаимозаменяемо, но
правильная терминология - компонент Razor.

Компонент Razor находится в файле с расширением .razor и компилируется как класс .NET в
время выполнения. Этот файл .razor также можно разделить на два файла с расширениями .razor и .razor.cs.
Идея очень похожа на XAML и программный код, о которых мы узнали в первой части этой книги.
В этой главе мы узнаем, как создавать компоненты Razor с использованием синтаксиса Razor. Далее мы поговорим
о Блазоре Васме.

# Общие сведения о Blazor Wasm

Blazor Wasm — это модель размещения, которая отображает компоненты Razor в веб-браузере. Компоненты бритвы
загруженные в браузере, компилируются в Wasm с использованием среды выполнения .NET, как мы можем видеть на рис. 7.2:

![изображение](https://user-images.githubusercontent.com/26972859/231839982-485fe51d-2c94-41e1-ac59-6b31f29c122e.png)
 
Рисунок 7.2: Blazor Wasm

В браузере стартовая страница загрузит среду .NET и компоненты Razor. Бритва
компоненты компилируются в Wasm с помощью интерпретатора .NET Intermediate Language (IL) во время выполнения.
для обработки изменений DOM. Это так называемая JIT-компиляция. С помощью JIT компиляция
происходит во время выполнения, поэтому производительность ниже, чем компиляция с опережением (AOT). Используя АОТ,
компиляция выполняется во время разработки, поэтому производительность во время выполнения может быть улучшена. Блейзор Васм
поддерживает компиляцию AOT в смешанном режиме в .NET 7, что означает, что часть кода .NET может быть скомпилирована
в Wasm на этапе разработки, чтобы добиться значительного улучшения производительности во время выполнения.
Смешанный режим AOT означает, что только часть IL-кода может быть скомпилирована в Wasm по техническим причинам.

## Wasm

Wasm — это двоичный формат инструкций для виртуальной машины на основе стека. Васм поддерживается
большинство современных веб-браузеров. С Wasm мы можем использовать множество языков программирования для разработки
клиентские компоненты.

В качестве платформы SPA мы можем сравнить Blazor с другими платформами SPA на основе JavaScript. Есть
многие фреймворки JavaScript SPA, такие как React, Angular и Vue. В таблице 7.1 мы сравнили
Блазор с React. Конечно, для сравнения мы можем использовать и другие фреймворки JavaScript. 
Причина, по которой я выбрал React, заключается в том, что React Native можно использовать для разработки гибридных приложений.
сходства с .NET MAUI Blazor, о которых мы поговорим в следующем разделе:

![изображение](https://user-images.githubusercontent.com/26972859/231840337-9be5c1ac-a025-4297-adb6-0175ab5814c4.png)

Таблица 7.1: Сравнение Blazor и React

И JavaScript, и Wasm являются встроенными функциями современных браузеров. Фреймворки SPA, использующие либо
JavaScript или Wasm не имеют дополнительных зависимостей для запуска в браузере.
Blazor Wasm поддерживает JavaScript Interop, поэтому компоненты JavaScript также могут использоваться Blazor.
Многие библиотеки JavaScript были перенесены в Blazor.
И Blazor, и React поддерживают разработку PWA, что делает SPA доступными в автономном режиме.
Производительность Blazor при первой загрузке немного выше, чем у React из-за дополнительной загрузки.
время выполнения .NET.

# Изучение Blazor Hybrid

Мы можем использовать Blazor в качестве уровня пользовательского интерфейса в настольных или мобильных нативных фреймворках, известных как Blazor.
Гибридные приложения. В приложении Blazor Hybrid компоненты Razor изначально визуализируются на устройстве с помощью
встроенный элемент управления WebView. Wasm не задействован, поэтому приложение имеет те же возможности, что и нативное приложение.
Как видно на рис. 7.3, в гибридном приложении мы можем использовать элемент управления BlazorWebView для создания и
запускать компоненты Razor внутри встроенного WebView. Элемент управления BlazorWebView доступен в
.NET MAUI и среды рабочего стола Windows. Мы можем создавать приложения Blazor Hybrid в .NET
MAUI, WPF или Windows Forms:

![изображение](https://user-images.githubusercontent.com/26972859/231840499-5fc356a4-6a9f-416d-a52a-7d066c8eceef.png)

Рисунок 7.3: BlazorWebView

Blazor Server, Blazor Wasm и Blazor Hybrid работают в разных средах выполнения, поэтому они
разные возможности. Мы можем создавать различные типы проектов, используя командную строку или Visual Studio.
Чтобы вывести список установленных шаблонов проектов, мы можем использовать следующую команду:

```
dotnet new --list

Эти шаблоны соответствуют вашему вводу:
Название шаблона Краткое название Язык
--------------------------- ------------------- ----------
Серверное приложение Blazor blazorserver [C#]
Blazorwasm приложения Blazor WebAssembly [C#]
Библиотека классов Razor razorclasslib [C#]
Приложение .NET MAUI maui [C#]
Приложение .NET MAUI Blazor maui-blazor [C#]
Библиотека классов .NET MAUI mauilib [C#]
Библиотека классов classlib [C#],F#,VB
```
В предыдущем списке мы отфильтровали ненужные типы проектов. Чтобы понять различные типы проектов
лучше, мы можем просмотреть сводку, изображенную в Таблице 7.2:

![изображение](https://user-images.githubusercontent.com/26972859/231840760-8f376c8f-aafe-4a31-97ea-64bbfc4d4928.png)

Таблица 7.2: Типы проектов, связанных с .NET MAUI и Blazor

В таблице 7.2 перечислены семь типов проектов. Их можно разделить на две группы — приложение Blazor
и приложение .NET MAUI. Давайте посмотрим на них.

# Блазор приложения

И для Blazor Server, и для Blazor Wasm целевой платформой является net6.0, но они используют разные пакеты SDK.
Приложение Blazor Server может в полной мере использовать возможности сервера с Microsoft.NET.Sdk.Web,
в то время как Blazor Wasm может получить доступ только к ограниченному набору .NET API, используя Microsoft.NET.Sdk.BlazorWasm.
Чтобы совместно использовать компоненты Razor между Blazor Server и Blazor Wasm, мы можем использовать библиотеку классов Razor,
который использует Microsoft.NET.Sdk.Razor. Стандартная библиотека классов .NET, которой могут пользоваться все
Приложения .NET 6.0 используют Microsoft.NET.Sdk.

# .NET приложения MAUI

Для приложения .NET MAUI мы можем создавать приложения .NET MAUI на основе XAML, используя Microsoft.NET.Sdk;
Приложения .NET MAUI Blazor используют Microsoft.NET.Sdk.Razor. Оба типа проектов нацелены на один и тот же набор
целевые рамки.
Для совместного использования компонентов можно использовать стандартную библиотеку классов .NET. Если функции .NET MAUI должны быть
используемые в общих компонентах, можно использовать библиотеку классов .NET MAUI. Например, PassXYZLib
— это библиотека классов .NET MAUI. И библиотека классов .NET, и библиотека классов .NET MAUI используют
тот же Microsoft.NET.Sdk, но они ориентированы на разные платформы.
Компоненты Razor в приложении .NET MAUI Blazor имеют полный доступ к собственным возможностям
устройства через SDK базовой платформы. Отношения между Blazor и Blazor Hybrid
похож на React и React Native. В приложении .NET MAUI Blazor и React Native обоим, возможно, придется
реализовать некоторый специфичный для платформы код. Мы можем использовать Таблицу 7.3, чтобы сравнить, как получить доступ к API для конкретных платформ в этих двух фреймворках.

# Платформозависимая реализация в .NET MAUI Blazor и React Native

В .NET MAUI полная реализация .NET доступна в целевой операционной системе. Например,
у нас есть все API .NET 6.0 и почти полная версия .NET API Android в net6.0-android.
Чтобы реализовать специфичную для платформы функцию в Android, нам не нужно использовать Android Studio и Java/
Котлин. Мы можем полностью реализовать его в среде .NET. Рекомендуемое решение состоит в том, чтобы
комбинируйте множественное нацеливание с частичными классами и частичными методами для вызова кода платформы из кроссплатформенного кода. Этот подход может улучшить возможность повторного использования кода и ограничить код, зависящий от платформы.
до минимального размаха.

В React Native нативные модули используются для реализации кода, зависящего от платформы. Для реализации нативного
модули, необходимо использовать специфичные для платформы инструменты. Например, Android Studio используется для реализации
Нативные модули Android и Xcode используются для iOS:

|Платформы|NET MAUI Blazor|React Native|
|:--------|:--------------|:-----------|
|Android|net6.0-android31.0/C#|Android Studio/Java или Kotlin|
|iOS|net6.0-ios15.2/C#|Xcode/Object-C или Swift|
|macOS|net6.0-maccatalyst15.2/C#|Н/Д|
|Windows|net6.0-windows10.0.19041/C#|Н/Д|

Таблица 7.3. Сравнение .NET MAUI Blazor и React Native

У обоих подходов есть плюсы и минусы. В реализации .NET MAUI как .NET-, так и
API-интерфейсы для конкретных платформ предоставляются в виде API-интерфейсов .NET на языке C#. Мы можем максимизировать повторное использование кода, чтобы
предоставлять специфичные для платформы реализации в виде кроссплатформенного API. Однако стремление сохранить
целевые рамки огромны.
В React Native нет стандартной реализации для конкретной платформы. Разработчикам нужно
разрабатывать их самостоятельно, когда им нужен доступ к функциям, специфичным для платформы. Он выглядит гибким,
но повторно использовать код во фреймворке сложно. Разные разработчики могут изобретать разные библиотеки
для доступа к тому же набору функций платформы. Разработчики собственных модулей должны приобретать различные навыки, чтобы
разрабатывать кроссплатформенные приложения.
Если мы создадим кроссплатформенное решение с помощью Blazor, можно разработать решение, включающее
веб-, мобильные, настольные и серверные службы, использующие единую архитектуру и язык программирования. 
общие компоненты могут быть повторно использованы во всех целевых приложениях.
Парадигма React Native заключается в том, что один раз выучился — пишешь где угодно. React и React Native используют
язык JavaScript и подобные фреймворки, но они не могут повторно использовать компоненты, как мы можем сделать это в Blazor.
React Native использует собственный пользовательский интерфейс, похожий на приложение .NET MAUI на основе XAML, в то время как
Приложения Blazor Hybrid используют пользовательские веб-интерфейсы на основе HTML.
Подводя итог, Blazor Hybrid и React Native имеют совершенно разные цели проектирования, поэтому их функции и
возможности разные. Вы должны сначала понять свои требования, прежде чем выбирать фреймворк.

# Создание нового проекта .NET MAUI Blazor

Чтобы научиться разрабатывать приложение Blazor Hybrid, мы должны обновить наш проект PassXYZ.Vault до
поддерживать пользовательский интерфейс на основе Blazor. Нам не нужно делать это с нуля — мы можем преобразовать наши текущие
проект, чтобы он поддерживал пользовательский интерфейс Blazor. Таким образом, мы можем создать как приложение на основе XAML, так и
Гибридное приложение, использующее тот же проект. Прежде чем мы добавим пользовательский интерфейс Blazor в наше приложение, мы можем создать новый .NET
Сначала проект MAUI Blazor с тем же именем приложения, чтобы мы могли обратиться к этому новому проекту для преобразования
наш проект в проект .NET MAUI Blazor. Мы можем создать новый проект .NET MAUI Blazor из командной строки или Visual Studio. Мы будем
продемонстрируйте оба в этом разделе.

# Создание проекта .NET MAUI Blazor с помощью командной строки dotnet

Давайте сначала создадим новый проект, используя командную строку .NET. Это можно сделать в любой Windows
или макОС.

Мы можем создать новый проект, используя короткое имя maui-blazor, указанное в таблице 7.2:

```
dotnet new maui-blazor -o PassXYZ.Vault
Welcome to .NET 6.0!
---------------------
SDK Version: 6.0.402
Telemetry
---------
The .NET tools collect usage data in order to help us improve
your experience. It is collected by Microsoft and shared with
the community. You can opt-out of telemetry by setting the
DOTNET_CLI_TELEMETRY_OPTOUT environment variable to '1' or
'true' using your favorite shell.
Read more about .NET CLI Tools telemetry: https://aka.ms/
dotnet-cli-telemetry
----------------
Installed an ASP.NET Core HTTPS development certificate.
To trust the certificate run 'dotnet dev-certs https --trust'
(Windows and macOS only).
Learn about HTTPS: https://aka.ms/dotnet-https
----------------
Write your first app: https://aka.ms/dotnet-hello-world
Find out what's new: https://aka.ms/dotnet-whats-new
Explore documentation: https://aka.ms/dotnet-docs
Report issues and find source on GitHub: https://github.com/dotnet/core
Use 'dotnet --help' to see available commands or visit:
https://aka.ms/dotnet-cli
--------------------------------------------------------------
------
The template ".NET MAUI Blazor App" was created successfully.
```

В предыдущей команде мы указали короткое имя maui-blazor для выбора проекта.
шаблон, и мы использовали PassXYZ.Vault в качестве имени проекта. После создания проекта мы
может построить и запустить его:

```
C:\ > dotnet build -t:Run -f net6.0-android
MSBuild version 17.3.2+561848881 for .NET
 Determining projects to restore...
 All projects are up-to-date for restore.
 PassXYZ.Vault -> C:\PassXYZ.Vault\Hybrid\bin\Debug\net6.0-
android\PassXYZ.Vault.dll
Build succeeded.
 0 Warning(s)
 0 Error(s)
Time Elapsed 00:01:43.79
```

Если вы используете более позднюю версию Visual Studio, вы можете указать другую структуру, например
как net7.0-андроид.
В команде сборки мы указываем net6.0-android в качестве целевой платформы для тестирования нашего нового
приложение. Мы можем обратиться к рисунку 7.5, чтобы увидеть скриншот этого нового приложения и структуры проекта. При этом мы
создали новый проект с помощью командной строки. Теперь давайте узнаем, как сделать то же самое с помощью Visual
Студия на Windows. Если вы используете Visual Studio на Mac, процесс очень похож.

# Создание проекта .NET MAUI Blazor с помощью Visual Studio в Windows

Чтобы создать проект .NET MAUI Blazor с помощью Visual Studio, мы можем запустить Visual Studio и выбрать «Создать».
новый проект, а затем введите MAUI в поле поиска. Как видно на рис. 7.4, мы можем выбрать .NET.
Приложение MAUI Blazor из списка шаблонов проекта:

![изображение](https://user-images.githubusercontent.com/26972859/231842167-e2159519-8792-4b49-b073-c4794ffb90c8.png)

Рисунок 7.4: Создание нового проекта .NET MAUI Blazor

Следуя указаниям мастера для создания проекта, мы можем выбрать net6.0-android в качестве цели.
framework для его создания и запуска. Для экономии места мы будем использовать здесь в качестве примера платформу Android;
вы можете выбрать другие целевые платформы, чтобы попробовать и протестировать их, если хотите.

# Запускаем новый проект

Чтобы запустить проект, мы можем нажать F5 или Ctrl + F5 в Visual Studio, или мы можем выполнить dotnet
команду из командной строки. Мы можем видеть скриншоты этого и структуру проекта на рисунке 7.5:

![изображение](https://user-images.githubusercontent.com/26972859/231842522-e761f082-0f02-49ce-82a2-a2fef1e896d6.png)

Рисунок 7.5: Скриншоты и структура проекта

Пользовательский интерфейс приложения, созданного из шаблона, выглядит как SPA с меню навигации в
топ на андроиде. Если мы запустим его в Windows с большим экраном, будет показано меню навигации.
бок о бок в левой части экрана. Структура проекта аналогична стандартному приложению .NET MAUI.
со следующими отличиями:

* wwwroot/: Эта папка является корнем статических файлов для веб-страниц.

* Pages/: эта папка содержит страницы Razor в приложении.

* Shared/: эта папка содержит компоненты Razor, которыми можно поделиться.

* Main.razor: это главная страница приложения Blazor.

* _Imports.razor: это помощник для импорта компонентов Razor на уровне папки или проекта.

Чтобы понять разницу между приложением .NET MAUI и приложением .NET MAUI Blazor, мы должны
просмотрите код запуска.

# Код запуска приложения .NET MAUI Blazor

Все приложения .NET MAUI содержат файл MauiProgram.cs для их запуска и настройки.
Давайте рассмотрим код запуска приложения .NET MAUI Blazor:

```Csharp
namespace PassXYZ.Vault;
public static class MauiProgram {
 public static MauiApp CreateMauiApp() {
 var builder = MauiApp.CreateBuilder();
 builder.UseMauiApp<App>()
 .ConfigureFonts(fonts => {
 fonts.AddFont("OpenSans-Regular.ttf",
 "OpenSansRegular");
 });
 builder.Services.AddMauiBlazorWebView(); ❶
#if DEBUG
 builder.Services.AddBlazorWebViewDeveloperTools(); ❷
#endif
 builder.Services.AddSingleton<WeatherForecastService>();
 return builder.Build();
 }
}
```

В версии .NET MAUI Blazor мы видим, что добавлены следующие конфигурации Blazor:
❶ BlazorWebView добавляется путем вызова AddMauiBlazorWebView().
❷ Инструменты разработчика добавляются путем вызова AddBlazorWebViewDeveloperTools() для отладки.
Остальная часть процесса запуска такая же, как и для приложения .NET MAUI на основе XAML. В App.xaml.
cs унаследованное свойство MainPage класса App имеет значение MainPage.xaml:

```Csharp
namespace PassXYZ.Vault;
public partial class App : Application {
 public App() {
 InitializeComponent();
 MainPage = new MainPage();
 }
}
```

Основное различие между приложениями на основе XAML и гибридными приложениями Blazor заключается в файле MainPage.xaml.
Давайте рассмотрим MainPage.xaml:

```Csharp
<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
 xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
 xmlns:local="clr-namespace:PassXYZ.Vault"
 x:Class="PassXYZ.Vault.MainPage"
 BackgroundColor="{DynamicResource PageBackgroundColor}">
 <BlazorWebView HostPage="wwwroot/index.html"> ①
 <BlazorWebView.RootComponents> ②
 <RootComponent Selector③="#app" ComponentType④=
 "{x:Type local:Main}" />
 </BlazorWebView.RootComponents>
 </BlazorWebView>
</ContentPage>
```
Существует только один элемент пользовательского интерфейса с именем BlazorWebView, определенный в MainPage.xaml. В
BlazorWebView, мы можем использовать свойство HostPage и вложенный компонент RootComponent
для настройки BlazorWebView.
Мы можем рассматривать BlazorWebView как браузер. Пользовательский интерфейс браузера загружается из HTML
файл. Свойство HostPage ① используется для указания статической страницы HTML, которая будет загружена в веб-представлении.
контроль. В нашем случае это wwwroot/index.html; мы рассмотрим его в листинге 7.1.
В этом статическом файле HTML нам нужно указать, где должен быть размещен компонент Razor и какой
Компонент Razor должен быть корневым компонентом. Мы можем указать как с помощью RootComponent
вложенный компонент ②.
В предыдущей главе мы узнали, что тег XAML в конечном итоге сопоставляется с классом C#. Здесь оба
BlazorWebView и RootComponent также являются классами C#.
В RootComponent мы используем свойство Selector ③, чтобы определить селектор CSS, который указывает
где должен быть размещен корневой компонент Razor в нашем приложении. В нашем случае это CSS-селектор #app.
определено в index.html. Свойство ComponentType ④ определяет тип корневого компонента.
В нашем случае это Main.

Наконец, давайте просмотрим файл HTML (index.html), о котором мы упоминали ранее:

**Листинг 7.1: index.html (https://epa.ms/index7-1)**

```xml
<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="utf-8" />
 <meta name="viewport" content="width=device-width,
 initial-scale=1.0, maximum-scale=1.0, user-
 scalable=no, viewport-fit=cover" />
 <title>PassXYZ.Vault</title>
 <base href="/" />
 <link rel="stylesheet" href="css/bootstrap/
 bootstrap.min.css" /> ❶
 <link href="css/app.css" rel="stylesheet" />
 <link href="PassXYZ.Vault.styles.css" rel="stylesheet" />
</head>
<body>
 <div class="status-bar-safe-area"></div>
 <div id="app">Loading...</div> ❷
 <div id="blazor-error-ui">
 An unhandled error has occurred.
 <a href="" class="reload">Reload</a>
 <a class="dismiss">✕</a>
 </div>
 <script src="_framework/blazor.webview.js"
 autostart="false"> ❸
 </script>
</body>
</html>
```

Мы видим, что index.html — это простой HTML-файл:
❶ Он использует таблицу стилей CSS из среды Bootstrap.
❷ Селектор идентификатора определяется как «приложение», которое мы передаем в атрибут Selector компонента RootComponent.
в MainPage.xaml.
❸ Файл JavaScript с именем blazor.webview.js загружается в конец index.html. Он инициализирует
среда выполнения BlazorWebView.
Итак, у нас есть обзор приложения .NET MAUI Blazor. В следующем разделе мы заменим
пользовательский интерфейс на основе XAML с пользовательским интерфейсом Blazor.

# Миграция на приложение .NET MAUI Blazor

Вместо того, чтобы делать все с нуля, мы можем использовать в нашем приложении как XAML, так и Blazor UI.
изменение конфигурации проекта со ссылкой на проект, который мы создали в предыдущем разделе.
Какое-то время мы будем использовать смешанный пользовательский интерфейс XAML и Blazor в одном приложении, пока не переместим все.
к Блазору.
Чтобы преобразовать наше приложение в приложение .NET MAUI Blazor, нам необходимо внести следующие изменения:
1. Измените SDK с Microsoft.NET.Sdk на Microsoft.NET.Sdk.Razor в
файл проекта, так как приложение .NET MAUI Blazor использует другой пакет SDK.
В файле проекта PassXYZ.Vault.csproj у нас есть следующая строка:
```<Project Sdk="Microsoft.NET.Sdk">```
Нам нужно заменить его на следующую строку:
```<Project Sdk="Microsoft.NET.Sdk.Razor">```

  2. Скопируйте следующие папки из нового проекта, который мы только что создали, в наше приложение:

  * wwwroot
  
  * Shared

  3. Скопируйте следующие файлы из нового проекта в наше приложение:
  
  * _Imports.razor
  
  * MainPage.xaml
  
  * MainPage.xaml.cs
  
  * Main.razor

4. Измените MauiProgram.cs, добавив следующий код:
```Csharp
Builder.Services.AddMauiBlazorWebView();
#if DEBUG
 builder.Services.AddBlazorWebViewDeveloperTools();
#endif
```

Чтобы просмотреть историю фиксации этих изменений, перейдите по адресу https://epa.ms/Blazor7-1.
С этими изменениями мы внесли все необходимые изменения в конфигурацию и готовы
чтобы перейти к следующему шагу. Однако, прежде чем мы начнем работать над этими изменениями, давайте познакомимся с
базовый синтаксис Razor.

# Понимание синтаксиса Razor

Приложения Blazor состоят из компонентов Razor. Как мы узнали из главы 3, проектирование пользовательского интерфейса с
XAML, XAML — это тип языка, производный от языка XML. Элементы пользовательского интерфейса на основе XAML
состоят из страниц XAML и файлов кода программной части C#. Компоненты Razor очень похожи на этот шаблон.
Разница в том, что Razor использует HTML в качестве языка разметки, а код C# можно встраивать в
HTML напрямую. При желании мы также можем отделить код C# в файле кода программной части, чтобы отделить
пользовательский интерфейс и логика.

# Блоки кода в Razor

Если мы добавим в проект новый компонент Razor, он будет выглядеть так:
  
```html  
<h3>Hello World!</h3>
@code {
 // Put your C# code here
}
```
В предыдущем примере мы можем оформить нашу страницу так же, как HTML-страницу, и поместить логику программирования
в кодовый блок. Страницы Razor или компоненты Razor будут созданы как классы C#. Имя файла
используется в качестве имени класса. Их можно использовать как теги HTML на другой странице Razor.

# Неявные выражения Razor

В синтаксисе Razor мы можем перейти от HTML к C#, используя символ @. Они называются неявными Razor
выражения. Например, мы можем использовать следующее неявное выражение, чтобы установить текст метки
тег с переменной C# currentUser.Username:
  
```xml
<label>@currentUser.Username</label>
```
Между неявными выражениями не должно быть пробелов. Мы не можем использовать дженерики C# в неявном
выражения, так как символы в квадратных скобках (<>) интерпретируются как тег HTML.  
  
# Явные выражения Razor  
  
Чтобы решить проблемы с неявными выражениями (такими как пробелы или использование дженериков), мы можем использовать явные
Выражения бритвы. Явные выражения Razor состоят из символа @ с круглыми скобками. Мы можем позвонить
общий метод, например:  
  
```Csharp
<p>@(GenericMethod<int>())</p>  
```
Когда мы хотим соединить текст с выражением, нам также нужно использовать явные выражения, например:  
  
```Csharp
<p>@(currentUser.FirstName)_@(currentUser.LastName)</p>
```  
Мы можем использовать явные выражения Razor в более сложных случаях, таких как передача лямбда-выражения
к обработчику событий. Давайте рассмотрим еще один случай использования явного выражения Razor при встраивании
HTML внутри кода C#.

# Кодировка выражений  
  
Иногда мы можем захотеть внедрить HTML как строку в код C#, но результат может быть не тем, что
мы ожидаем.
  
Допустим, мы пишем следующее выражение C#:
  
```@("<span>Hello World!</span>")```
  
Результат будет выглядеть так после рендеринга:
  
```&lt;span&gt;Hello World&lt;/span&gt;```
  
Чтобы сохранить строку HTML, нам нужно использовать ключевое слово MarkupString, например:
  
```@((MarkupString)"<span>Hello World</span>")```
  
Результат предыдущего выражения C# выглядит следующим образом:
  
```<span>Hello World!</span>```
  
Это результат, который нам нужен. Мы узнаем больше о явных выражениях Razor, когда будем создавать
Компоненты бритвы.  
  
# Директивы
  
Помимо кода HTML и блоков кода C#, существует набор зарезервированных ключевых слов, которые можно использовать в качестве Razor.
директивы. Директивы Razor представлены неявными выражениями с зарезервированными ключевыми словами после
@ символ. Мы видели блок кода как @code в предыдущем разделе. Здесь @code — это директива с
зарезервированное ключевое слово кода. Ниже приведены директивы, которые мы можем использовать в этой книге:  
  

  * @attribute: используется для добавления данного атрибута в класс

  * @code: используется для определения блока кода

  * @implements: используется для реализации интерфейса сгенерированного класса.

  * @inherits: используется для указания родительского класса для сгенерированного класса

  * @inject: используется для внедрения службы с использованием внедрения зависимостей.

  * @layout: используется для указания макета маршрутизируемых компонентов Razor.

  * @namespace: используется для определения пространства имен для сгенерированного класса.

  * @page: используется для определения маршрута страницы

  * @using: это похоже на ключевое слово using в C#, которое импортирует пространство имен.  
  
  
  # Атрибуты директивы
  
  На странице Razor теги HTML могут быть классами, а атрибуты могут быть членами класса. Давайте рассмотрим
следующий пример:
  
```xml
<input type="text" @bind="currentUser.Username">  
```
Здесь input — это тег HTML, который является классом. Атрибут type является свойством входного тега,
который присваивается "текстовой" строке. Возможно, вы заметили, что другой атрибут с именем @bind
выглядит немного иначе, чем обычный атрибут. Это похоже на неявное выражение Razor. Да, это
неявное выражение и привязка являются зарезервированными ключевыми словами. Это директивный атрибут. Разница между
директива Razor и атрибут директивы Razor заключается в том, что последний используется как атрибут HTML
ярлык. Ниже приведены директивные атрибуты, которые мы будем использовать в этой книге:

  * @bind: используется при привязке данных

  * @on{EVENT}: используется при обработке событий.

  * @on{EVENT}:preventDefault: используется для предотвращения действия по умолчанию для события

  * @on{EVENT}:stopPropagation: используется для остановки распространения события.

  * @ref: используется для предоставления ссылки на экземпляр компонента.

  * @typeparam: используется для объявления параметра универсального типа.  
  
Теперь, когда мы узнали об основном синтаксисе языка разметки Razor, давайте перейдем к
реальная работа.  
  
# Создание компонента Razor  
  
Чтобы разработать приложение .NET MAUI Blazor, мы можем выбрать создание всех пользовательских интерфейсов с помощью Blazor или сочетания
компонентов Razor с компонентами XAML. Сначала мы начнем со второго варианта, так как мы
уже есть законченное приложение менеджера паролей из главы 6, Знакомство с внедрением зависимостей
и услуги для конкретных платформ.  
  
# Редизайн страницы входа с использованием компонента Razor  
  
Пользовательский интерфейс, который мы хотим заменить в первую очередь, — это страница входа. Мы можем использовать страницу Razor для замены
страницу XAML для выполнения той же функции.
В приложении Blazor Hybrid BlazorWebView — это элемент управления, в котором размещаются компоненты Razor. Мы можем
измените LoginPage.xaml на следующее  
  
```xml
<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com
/dotnet/2021/maui"
 xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
 xmlns:b="clr-namespace:Microsoft.AspNetCore.Components.
 WebView.Maui;
 assembly=Microsoft.AspNetCore.Components.WebView.Maui"
 xmlns:local="clr-namespace:PassXYZ.Vault.Pages"
 x:Class="PassXYZ.Vault.Views.LoginPage"
 Shell.NavBarIsVisible="False">
 <b:BlazorWebView HostPage="wwwroot/login.html"> ❶
 <b:BlazorWebView.RootComponents>
 <b:RootComponent Selector="#login-app" ❸
 ComponentType="{x:Type local:Login}" /> ❷
 </b:BlazorWebView.RootComponents>
 </b:BlazorWebView>
</ContentPage>
```
Предыдущая страница содержит только элемент управления BlazorWebView. Здесь мы можем обратить внимание на
Следующие пункты:

  * Атрибут HostPage используется для указания HTML-страницы для загрузки в BlazorWebView. Это
login.html (листинг 7.2) в данном случае.
Атрибуты RootComponent определяют используемый компонент Razor и селектор CSS:

  * Атрибут ComponentType указывает компонент Razor Login; мы будем работать над этим в ближайшее время.

  * Атрибут Selector определяет селектор CSS, на который будет загружаться наш веб-интерфейс. Мы определили
идентификатор CSS #login-app в файле login.html. HTML-страница login.html создается и сохраняется.
в папке wwwroot. Давайте рассмотрим это в листинге 7.2:  
  
**Листинг 7.2: login.html (https://epa.ms/Login7-2)**  
  
```xml
<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="utf-8" />
 <meta name="viewport" content="width=device-width,
 initial-scale=1.0, maximum-scale=1.0, user-scalable=no,
 viewport-fit=cover" />
 <title>PassXYZ.Vault Login</title>
 <base href="/" />
 <link rel="stylesheet" href="css/bootstrap/
 bootstrap.min.css" />
 <link href="css/app.css" rel="stylesheet" />
 <link href="PassXYZ.Vault.styles.css" rel="stylesheet" />
</head>
<body class="text-center">
 <div id="login-app">Loading...</div> ①
 <div id="blazor-error-ui">
 An unhandled error has occurred.
 <a href="" class="reload">Reload</a>
 <a class="dismiss">✕</a>
 </div>
 <script src="_framework/blazor.webview.js"
 autostart="false">
 </script>
</body>
</html>
```
Как видно из листинга 7.2, он очень похож на index.html, который мы обсуждали ранее. Он определяет
следующий идентификатор CSS «login-app» ①, который используется для загрузки нашего компонента Razor:  
  
```<div id="login-app">Loading…</div>```
  
В шаблоне .NET MAUI Blazor используется CSS-фреймворк Bootstrap (bootstrap.min.css).
загружается по умолчанию. На момент написания встроенная версия Bootstrap была 5.1. Вы можете найти
более новая версия в вашем проекте.
Bootstrap — известная платформа для веб-разработки. Он содержит множество примеров того, как
используй это. Для страницы входа на веб-сайте Bootstrap есть пример входа, как показано на рис. 7.6.
Мы будем использовать его для создания нашего компонента входа в систему:  
  
![изображение](https://user-images.githubusercontent.com/26972859/231845068-0bcfaa88-aca2-4e2d-be2a-ba24dacbaee5.png
 
Рисунок 7.6: Пример входа через Bootstrap  
  
Вы можете найти этот пример входа по адресу https://getbootstrap.com/docs/5.1/examples/sign-in/.  
  
Этот пример входа включает два файла:

  * index.html (листинг 7.3) — это пользовательский интерфейс страницы входа. Он определяет следующее:

  * Два тега ```<input>``` для имени пользователя ❶ и пароля ❷

  * Тег ```<input>``` ❸ для флажка, чтобы запомнить имя пользователя

  * Тег ```<button>``` ❹ для обработки входа в систему

  * Он использует стили Bootstrap CSS и собственные стили, определенные в signin.css.

  * signin.css (листинг 7.4) определяет стили CSS, характерные для страницы входа:  
  
  **Листинг 7.3: index.html (пример входа через Bootstrap)**
  
 ```xml
 <!doctype html>
<html lang="en">
 <head> ... </head>
 <body class="text-center">
<main class="form-signin"> 
 <form>
<img class="mb-4" src=".../bootstrap-logo.svg"
 alt="" width="72" height="57">
 <h1 class="h3 mb-3 fw-normal">Please sign in</h1>
 <div class="form-floating">
 <input type="email" class="form-control"
 id="floatingInput" placeholder="name@example.com">❶
 <label for="floatingInput">Email address</label>
 </div>
 <div class="form-floating">
 <input type="password" class="form-control"
 id="floatingPassword" placeholder="Password"> ❷
 <label for="floatingPassword">Password</label>
 </div>
 <div class="checkbox mb-3">
 <label>
 <input type="checkbox" value="remember-me"> ❸
 Remember me
 </label>
 </div>
<button class="w-100 btn btn-lg btn-primary"
 type="submit">Sign in</button> ❹
 <p class="mt-5 mb-3 text-muted">&copy; 2017–2021</p>
 </form>
</main>
 </body>
</html>
```
В signin.css (листинг 7.4) мы настраиваем CSS-класс form-signin, который используется в
страница входа в index.html:
  
**Листинг 7.4: signin.css (пример входа через Bootstrap)**  
  
```css
html,
body {
 height: 100%;
}
body {
 display: flex;
 align-items: center;
 padding-top: 40px;
 padding-bottom: 40px;
 background-color: #f5f5f5;
}
.form-signin {
 width: 100%;
 max-width: 330px;
 padding: 15px;
 margin: auto;
}
.form-signin .checkbox {
 font-weight: 400;
}
.form-signin .form-floating:focus-within {
 z-index: 2;
}
.form-signin input[type="email"] {
 margin-bottom: -1px;
 border-bottom-right-radius: 0;
 border-bottom-left-radius: 0;
}
.form-signin input[type="password"] {
 margin-bottom: 10px;
 border-top-left-radius: 0;
 border-top-right-radius: 0;
}
```
Чтобы создать новый компонент Razor, мы должны создать в проекте папку Pages. После этого,
мы можем щелкнуть правой кнопкой мыши папку Pages, которую мы только что создали в Visual Studio, и выбрать «Добавить -> Компонент Razor».
Мы можем назвать этот компонент Login.razor и создать его. После создания файла мы
можно скопировать часть между тегом ```<main>``` из листинга 7.3 на страницу Razor внутри ```<div>```
тег, как показано в листинге 7.5:  
  
**Листинг 7.5: Login.razor (https://epa.ms/Login7-5)**
  
```html
@using System.Diagnostics
@using PassXYZ.Vault.Services
@using PassXYZ.Vault.ViewModels
@inject LoginViewModel viewModel ❶
<div>
 <main class="form-signin">
 <form>
 <img class="mb-4"...>
 <h1 class="h3 mb-3 fw-normal">Please sign in</h1>
 <div class="form-floating">
 <label for="floatingInput">Username</label>
 <input type="text" @bind="@currentUser.Username" ❹
 class="form-control" id="floatingInput"
 placeholder="Username">
 </div>
 <div class="form-floating">
 <label for="floatingPassword">Password</label>
 <input type="password" @bind="@currentUser
 .Password" class="form-control"
 id="floatingPassword" placeholder=
 "Password">
 </div>
 <div class="checkbox mb-3">
 <label>
 <input type="checkbox" value="remember-me">
 Remember me
 </label>
 </div>
 <button class="w-100 btn btn-lg btn-primary"
 type="submit" @onclick="OnLogin">Sign in</button>
 <p class="mt-5 mb-3 text-muted">&copy; 2017–2021</p>
 </form>
 </main>
</div>
@code {
 private LoginUser currentUser { get; set; } = default!; ❷
 protected override void OnInitialized() { ❸
 if (currentUser == null) {
 currentUser = viewModel.CurrentUser;
 }
 }
 private void OnLogin(MouseEventArgs e) {
 viewModel.OnLoginClicked(); 
 }
}
```
  
Как видно из Login.razor, Razor — это язык разметки, который может смешивать HTML-страницы с C#.
код. Мы можем встроить код C# после символа @ в HTML или поместить код C# внутрь блока @code.  
  
В блоке @code мы определяем закрытую переменную с именем currentUser ❷ типа LoginUser.
Мы инициализируем currentUser в методе переопределения OnInitialized() ❸ свойством
модель представления. Мы можем ссылаться на currentUser в HTML после символа @ ❹. Точно так же
мы можем определить обработчик события OnLogin() и ссылаться на него в событии onclick.
Как только пользователь вводит свое имя пользователя и пароль, свойства currentUser заполняются.
пользователь нажимает кнопку входа, вызывается OnLogin(). OnLoginClicked() модели представления
метод используется для выполнения действия входа в систему.  
  
# Шаблон Model-View-ViewModel (MVVM) в Blazor

  Преимущество использования Blazor для дизайна пользовательского интерфейса заключается в том, что мы можем сделать большую часть дизайна пользовательского интерфейса.
используя HTML в первую очередь. Как только мы будем удовлетворены дизайном пользовательского интерфейса, мы можем добавить нашу программную логику в
дизайн. Чтобы разделить обязанности при проектировании, мы можем использовать паттерн MVVM, который мы изучили
в главе 3 «Проектирование пользовательского интерфейса с помощью XAML» в разделе «Разработка компонентов Razor». В Блазоре,
мы можем рассматривать HTML-разметку как представление, а блок кода — как модель представления. Если логика в коде
блок слишком сложен, мы можем выделить его в файл кода программной части C#.
На странице входа мы по-прежнему можем использовать LoginViewModel из мира XAML. Это потому что
мы перейдем от Blazor обратно к пользовательскому интерфейсу XAML внутри LoginViewModel. Это делается только для того,
продемонстрируйте, как мы можем смешивать пользовательские интерфейсы Blazor и XAML в одном приложении. Мы заменим пользовательский интерфейс XAML
с пользовательским интерфейсом Blazor в следующей главе.
В компоненте Razor мы можем либо поместить HTML и C# в один файл, либо разделить его на Razor.
файл и файл кода программной части C#, как XAML.
Давайте сделаем это для Login.razor. Если мы разделим его на два файла, компонент будет разделен на два частичных
классы, находящиеся в файлах Login.razor и Login.razor.cs, как мы видим в листинге 7.6 и листинге 7.7:
  
**Листинг 7.6. Login.razor (https://epa.ms/Login7-6)**  
  
```html
@namespace PassXYZ.Vault.Pages
<div>
 <main class="form-signin">
 <form>
 <img class="mb-4"...>
 <h1 class="h3 mb-3 fw-normal">Please sign in</h1>
 <div class="form-floating">
 <label for="floatingInput">Username</label>
 <input type="text" @bind="@currentUser.Username"
 class="form-control" id="floatingInput"
 placeholder="Username">
 </div>
 <div class="form-floating">
 <label for="floatingPassword">Password</label>
 <input type="password" @bind="@currentUser.
 Password" class="form-control"
 id="floatingPassword" placeholder="Password">
 </div>
 <div class="checkbox mb-3">
 <label>
 <input type="checkbox" value="remember-me"> Remember me
 </label>
 </div>
 <button class="w-100 btn btn-lg btn-primary"
 type="submit" @onclick="OnLogin">Sign in</button>
 <p class="mt-5 mb-3 text-muted">&copy; 2021–2022</p>
 </form>
 </main>
</div>
```
В листинге 7.6 HTML-разметка присутствует только в файле Login.razor. Это делает его лучше с точки зрения
разделение пользовательского интерфейса и логики. Давайте рассмотрим соответствующий код C# в листинге 7.7:  
  
**Листинг 7.7: Login.razor.cs (https://epa.ms/Login7-7)**  
  
```Csharp
using Microsoft.AspNetCore.Components;
using System.Diagnostics;
using PassXYZ.Vault.Services;
using PassXYZ.Vault.ViewModels;
using Microsoft.AspNetCore.Components.Web;
namespace PassXYZ.Vault.Pages;
public partial class Login : ComponentBase {
 [Inject]
 LoginViewModel viewModel { get; set; } = default!;
 private LoginUser currentUser { get; set; } = default!;
 protected override void OnInitialized() {
 if (currentUser == null) {
 currentUser = viewModel.CurrentUser;
 }
 }
 private void OnLogin(MouseEventArgs e) {
 viewModel.OnLoginClicked();
 }
}
```
В листинге 7.7 мы переместили весь код из блока @code в файл C# внутри класса Login, который
является производным от класса ComponentBase. Все компоненты Razor являются производными от ComponentBase.
Вы могли заметить, что в объявлении модели представления есть атрибут Inject.
свойство. Это используется для внедрения зависимостей.  
  
# Внедрение зависимостей в Blazor  
  
Мы представили внедрение зависимостей в Главе 6, Знакомство с внедрением зависимостей и специфическими для платформы службами. Все знания в этой главе в равной степени применимы и здесь, но Blazor предоставляет больше.
С Blazor мы можем использовать внедрение зависимостей как в HTML, так и в C#.
Как показано в листинге 7.5, в начале файла Login.razor определено следующее объявление:  
  
```@inject LoginViewModel viewModel```  
  
Здесь мы внедряем класс LoginViewModel в переменную viewModel. Это инъекция свойств,
и мы можем использовать внедрение свойств намного проще, чем раньше в Blazor.
Чтобы использовать внедрение зависимостей, нам нужно зарегистрировать LoginViewModel в MauiProgram.cs, так как мы
сделал в Главе 6, Знакомство с внедрением зависимостей и специфичными для платформы сервисами:  
  
```Csharp
builder.Services.AddSingleton<LoginViewModel,LoginViewModel>();
```
Когда мы перемещаем его в файл кода программной части C#, мы можем использовать атрибут Inject, чтобы сделать то же самое:  
  
```Csharp
[Inject]
 LoginViewModel viewModel { get; set; } = default!;
```
В веб-разработке мы обычно используем вместе стили HTML и CSS для разработки пользовательских веб-интерфейсов.
В примере с Bootstrap есть файл signin.css. Где мы храним наши стили CSS? Давайте посмотрим
в этой теме в следующем разделе.  
  
# CSS-изоляция

Когда мы представили пример входа в Bootstrap, мы упомянули, что есть файл HTML и
CSS-файл. Куда мы поместим этот файл CSS, чтобы мы могли повторно использовать стили CSS входа на нашей странице входа?
В HTML-дизайне, когда мы используем структуру CSS, такую ​​как Bootstrap, иногда нам также нужно
настроить стили на уровне страницы. Для поддержки этого в Blazor существует техника, называемая изоляцией CSS.
для компонентов Razor. Для стилей CSS, специфичных для компонентов или страниц, мы можем хранить их в файле с
Расширение .razor.css. Имя файла должно совпадать с именем файла .razor в той же папке.
Для нашей страницы входа мы можем скопировать файл sign-in.css из примера Bootstrap в файл Login.razor.
css и внесите небольшие изменения, как показано в листинге 7.8:  
  
# Листинг 7.8: Login.razor.css (https://epa.ms/Login7-8)  
  
```CSS
div {
 display: flex;
 align-items: center;
 background-color: #f5f5f5;
}
.form-signin {
 width: 100%;
 max-width: 330px;
 padding: 15px;
 margin: auto;
}
.form-signin .checkbox {
 font-weight: 400;
}
.form-signin .form-floating:focus-within {
 z-index: 2;
}
.form-signin input[type="email"] {
 margin-bottom: -1px;
 border-bottom-right-radius: 0;
 border-bottom-left-radius: 0;
 }
.form-signin input[type="password"] {
 margin-bottom: 10px;
 border-top-left-radius: 0;
 border-top-right-radius: 0;
}
```
Стили, определенные в файле Login.razor.css, применяются только к визуализируемому выходу входа.
компонент. Наконец, давайте посмотрим на этот новый пользовательский интерфейс входа в Blazor:  
  
 ![изображение](https://user-images.githubusercontent.com/26972859/231849849-fe4f7cbd-c896-409a-9bda-65d308f18af5.png)
  
 Рисунок 7.7: Страница входа
  
Мы видим, что внешний вид этого нового пользовательского интерфейса на рис. 7.7 (показанного в iOS) такой же, как у
из примера входа в Bootstrap, за исключением того, что мы изменили значок. Функционал входа в систему
не изменилось, за исключением того, что мы использовали Blazor для создания нового пользовательского интерфейса. После того, как мы войдем в систему, используя эту страницу Razor,
остальная логика программирования остается такой же, как показано в Главе 6, Знакомство с зависимостями.
Внедрение и сервисы для конкретных платформ. Платформа пользовательского интерфейса переключается обратно на XAML после входа в систему, поскольку
после этого мы еще ничего не меняли.
  
# Краткое содержание

В этой главе мы узнали о Blazor и о том, как разработать приложение Blazor Hybrid. Блазор — это
альтернативное решение для дизайна пользовательского интерфейса для .NET MAUI. Разница между Blazor и XAML заключается в том, что
внешний вид пользовательского интерфейса XAML такой же, как собственный пользовательский интерфейс, но Blazor
Пользовательский интерфейс имеет внешний вид веб-приложения. С точки зрения функциональных возможностей, которые они могут предоставить, существует
не большая разница. Мы можем смешивать Blazor и XAML в одном приложении. Мы можем использовать шаблон MVVM в
как XAML, так и Blazor. В Blazor код пользовательского интерфейса может совместно использоваться приложением Blazor Hybrid и
веб-приложение. Если вы ищете решение, которое поддерживает как собственные, так и веб-приложения, .NET MAUI
Blazor может быть хорошим выбором.
В следующей главе мы заменим все пользовательские интерфейсы в нашем приложении с помощью Blazor. Мы также представим
как сделать первоначальный дизайн пользовательского интерфейса с помощью макета и маршрутизации.  

